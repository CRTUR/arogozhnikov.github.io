---
layout: post
title: Vector representations of categories
date: '2015-05-04T13:32:00.001-07:00'
author: Alex
tags:
- Machine Learning
- Python
- Graphical Models
- Optimization
modified_time: '2015-05-10T03:27:56.652-07:00'
blogger_id: tag:blogger.com,1999:blog-307916792578626510.post-4262878322177076411
blogger_orig_url: http://brilliantlywrong.blogspot.com/2015/05/vector-representations-of-categories.html
---

<p>After thinking a while over the last point in my list of  <a href='http://brilliantlywrong.blogspot.com/2015/04/plans-for-ml-experiments.html'>topics</a> in machine learning I was going to think over... </p><p>I finally came to the thought that I'd better use some <b>graphical model</b>, since there is a great majority of possible algorithms without any warranty of their workability. </p><p>So, first thing - probably one can use LDA (Latent Dirichlet allocation,  <a href='http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation'>wiki</a>) to find good representation for categories. In this case we should use bag-of-words model, and `categories` will stand for words. <br />Yes, the model of LDA doesn't seem to be appropriate, though I'm sure it will give reasonable representations. </p> <p> Another graphical model I came with, is much simpler (and probably was developed a long time ago, but I don't know). <br />It's generative model looks looks this: <br><ol><li> First, a `topic` of event is generated. That's an n-dimensional vector $t_{event} \in \mathbb{R}^n$ drawn from gaussian distribution. </li><li>For each category, say, `site_id`, each value of site_id has it's own topic $t_{cat.value}$ of same dimension $n$. The greater dot product $(t_{cat.value}, t_{event})$, the higher probability that this value of category will be chosen. I shall stress here, that I'm not thinking over the arbitrary number of categories, I'm currently interested in the case, where the number and types of categories are fixed. </li><li>To be more precise, the probability of each value within category to be drawn for the event with $t_{event}$ vector is propostional to  $$ p(\text{cat_value} | \text{event}) \sim p(\text{cat.value}) \times e^{(t_{cat.value}, t_{event})} $$ so, to compute final probability one shall use  <a href='http://en.wikipedia.org/wiki/Softmax_function'>softmax</a> function. </li></ol> That said, currently the problem I expect to meet is extremely low speed of training when the number of values for some category is very large (say, there are cases when number of categories one shall proceed is greater then 10000)  </p> <p>PS. After writing this I understood that usage of decision trees to generate ids of leaves - new 'categories' + usage of LibFM over these new features was a very interesting and good idea. </p>     